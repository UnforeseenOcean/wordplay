/*

WordPlay
The Office For Creative Research
May, 2014

https://github.com/blprnt/wordplay

*/


var rita = require('rita');

var corpusList = ["shakes","bible","freud","mobydick","bieber"];
var corpii = [];

for (var i = 0; i < corpusList.length; i++) {
	console.log("LOADING CORPUS: " + corpusList[i]);
	corpii[corpusList[i]] = require('corpii/' + corpusList[i] + '.json');
}

function getWordMatches(pattern, corp) {
	console.log("Requested match for: " + pattern)
	//Get match parameters for the input string
	var match = rita.RiTa.getPosTags(pattern).join(" ");
	var stresses = rita.RiTa.getStresses(pattern);
	var syllables = countSyllables(stresses);
	console.log(match + ":" + stresses + ":" + syllables);

	//choose the correct corpus
	var corpus = corpii[corp];

	if (corpus) {

	//Go through the corpus and extract lines that have a match somewhere for the POS
	var candidates = [];
	for(var i = 0; i < corpus.lines; i++) {
		var line = corpus.lines[i];
		if (line.pos.indexOf(match) != -1) console.log(line.text); 
	}

	} else {
		console.log("COULDN'T LOAD CORPUS: " + corp);
	}



	return("Results");
}

function countSyllables(s) {
	var syllables = 0;
  	var sswords = s.split(" ");
	 for (var i = 0; i < sswords.length; i++) {
	    syllables += sswords[i].split("/").length;
	 }
	 return(syllables);

}

module.exports.getWordMatches = getWordMatches;